<%= render "layouts/small_banner"%>
<div class="container p-0">

<% if @cart.is_empty? %>

<div>
  Votre panier est vide !

  <%= link_to 'Voir les items', root_path, class: 'btn btn-lg btn-primary' %>
</div>

<% else %>
      <% @items.each do |item| %>

      <div class="row border no-gutters text-center">
        <div class="col-md-2 col-5 my-auto"><img src="<%= item.image_url %>" height="200" alt="">
        </div>

        <div class="col-md-10 col-7 row no-gutters border-left">
          <div class="col-md-6 m-auto">
            <h3><%= item.title %></h3>
            <%= item.price %>
          </div>
          <div class="col-md-6 m-auto">
            <%= link_to "Retirer du panier", item_join_table_carts_item_path(item_id: item.id, id: JoinTableCartsItem.find_by(item_id:item.id, cart_id:@cart.id).id), method: :delete, class: 'btn btn-primary' %>
          </div>
        </div>
      </div>

      <% end %>

    <div class="row no-gutters justify-content-end">

      <div class="amount border p-3 col-md-3 text-center">
        Total : <%= @cart.total_price %> â‚¬
      </div>
    </div>

      <div class="row justify-content-end">
        <div class="col-md-3 text-center">


      <%= form_tag user_orders_path() do %>
          <div>
            <% if flash[:error].present? %>
              <div id="error_explanation">
                <p><%= flash[:error] %></p>
              </div>
            <% end %>
          </div>

          <button class="btn btn-lg btn-secondary m-3">Valider
            <script src="https://checkout.stripe.com/checkout.js" class="stripe-button"
                    data-key="<%= Rails.configuration.stripe[:publishable_key] %>"
                    data-email="<%= current_user.email %>"
                    data-description="Merci de renseigner les informations ci-dessous"
                    data-amount="<%= @cart.total_price*100 %>"
                    data-locale="auto"
                    data-currency="eur"></script>
          </button>
      <% end %>
    </div>
    </div>
  <% end %>
</div>
